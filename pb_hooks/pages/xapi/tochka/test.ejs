<%
/**
 * GET /xapi/tochka/test
 * Тестовый эндпоинт для проверки работы middleware и load
 */

const { data, response } = $req;

// Проверим, что пришло из middleware и load
const debugInfo = {
  hasConfig: !!data.tochkaConfig,
  hasMakeApiRequest: typeof data.makeApiRequest === 'function',
  hasEndpoints: !!data.ENDPOINTS,
  config: data.tochkaConfig ? {
    hasJwt: !!data.tochkaConfig.jwt_token,
    hasClientId: !!data.tochkaConfig.client_id,
    hasAccountId: !!data.tochkaConfig.account_id
  } : null
};

response.json(200, {
  success: true,
  message: 'Тестовый эндпоинт работает',
  debug: debugInfo
});
%>
