<%
meta('layout', false);

if (request.method !== 'DELETE') {
    return response.json(405, {
        success: false,
        message: 'Используйте метод DELETE'
    });
}

try {
    const formData = body();
    
    if (!formData.id) {
        return response.json(400, {
            success: false,
            message: 'ID партнера не указан'
        });
    }
    
    // Загружаем запись
    const record = $app.findRecordById('partners', formData.id);
    const partnerName = record.get('name');
    
    // Удаляем запись
    $app.delete(record);
    
    return response.json(200, {
        success: true,
        message: `Партнер "${partnerName}" удален`
    });
    
} catch (error) {
    console.error('[partners/delete] Error:', error);
    return response.json(500, {
        success: false,
        message: error.message || 'Ошибка удаления партнера'
    });
}
%>
